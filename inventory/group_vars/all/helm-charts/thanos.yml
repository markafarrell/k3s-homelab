---
thanos_state: present

thanos_s3_access_key: !vault |
          $ANSIBLE_VAULT;1.2;AES256;vault
          61376330613231346630353166373939613064636664656435393566633264353361626430353766
          6135353435333764343262383132373533656134626337380a313936346630646564636265653563
          64373330386361663938353665393138303532303762313633393639663235336466373430343533
          3231326663663037320a373664356635313264316539613233323437613562633931386561333466
          38343130323639343531646666333332313362633361623266653932393336643136

thanos_s3_secret_key: !vault |
          $ANSIBLE_VAULT;1.2;AES256;vault
          39666639386330363634316461316238633563396364636161346438343536333938323333666436
          3839643065376430323834366637353835346263333334640a663738646231643666613739643565
          61393937316461633239613630666131326564323665623464636533376630363730623731353830
          6137653865616465320a373230623339633630393631353261626232373736396237333065643566
          38666132383539396232396330326431623965373263303534623433333265353463643064343865
          3165323432306130646632313966303431333231306332346332

thanos_s3_config:
  type: s3
  config:
    bucket: homelab-thanos-data #S3 bucket name
    endpoint: s3.ap-southeast-2.amazonaws.com #S3 Regional endpoint
    access_key: "{{ thanos_s3_access_key }}"
    secret_key: "{{ thanos_s3_secret_key }}"

thanos_helm_chart:
  chart_name: markafarrell/thanos
  version: 1.0.0
  repositories:
    - name: markafarrell
      repo_url: https://markafarrell.github.io/helm-charts/
  name: thanos
  state: "{{ thanos_state }}"
  namespace: monitoring
  secrets:
    - name: thanos-storage-secret
      content:
        s3.yml: "{{ thanos_s3_config | to_nice_yaml | b64encode }}"
  values:
    store:
      objStoreConfigFile: /etc/secret/s3.yml
